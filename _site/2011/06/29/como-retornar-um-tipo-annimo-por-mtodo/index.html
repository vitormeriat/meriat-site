<!DOCTYPE html>
<html>

  <head>
  <!--<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Como retornar um tipo anônimo por método | Vitor Meriat</title>
  <meta name="author" content="">
  <meta name="description" content="">
  <meta property="og:title" content="Como retornar um tipo anônimo por método | Vitor Meriat">
  <meta property="og:url" content="http://localhost:4000/2011/06/29/como-retornar-um-tipo-annimo-por-mtodo/">
  <meta property="og:site_name" content="Vitor Meriat">
  <meta property="og:description" content="">
  <meta property="og:image" content="">
  <meta property="og:type" content="blog">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:description" content="">
  <meta name="twitter:title" content="Como retornar um tipo anônimo por método | Vitor Meriat">
  <meta name="twitter:url" content="http://localhost:4000/2011/06/29/como-retornar-um-tipo-annimo-por-mtodo/">
  <meta name="twitter:site" content="Vitor Meriat">
  <meta name="twitter:creator" content="@">
  <meta name="twitter:domain" content="http://localhost:4000">
  <meta property="twitter:image" content="">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Lora|Space+Mono:700">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">

  <link rel="alternate" type="application/rss+xml" title="Vitor Meriat" href="http://localhost:4000/feed.xml">
  <link rel="canonical" href="http://localhost:4000/2011/06/29/como-retornar-um-tipo-annimo-por-mtodo/">

  -->



  <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Vitor Meriat</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Vitor Meriat" />
	<meta name="keywords" content="cloud computing, machine learning, big data, iot, developer, data scientist" />
	<meta name="author" content="Vitor Meriat" />

	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content="" />
	<meta property="og:image" content="" />
	<meta property="og:url" content="" />
	<meta property="og:site_name" content="" />
	<meta property="og:description" content="" />
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="/assets/favicon.ico">

	<!-- Google Webfont -->
	<link href='https://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
	<!-- Themify Icons -->
	<link rel="stylesheet" href="/assets/css/themify-icons.css">
	<!-- Icomoon Icons -->
	<link rel="stylesheet" href="/assets/css/icomoon-icons.css">
	<!-- Bootstrap -->
	<link rel="stylesheet" href="/assets/css/bootstrap.css">
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
	<link rel="stylesheet" href="/assets/css/owl.theme.default.min.css">
	<!-- Magnific Popup -->
	<link rel="stylesheet" href="/assets/css/magnific-popup.css">
	<!-- Easy Responsive Tabs -->
	<link rel="stylesheet" href="/assets/css/easy-responsive-tabs.css">
	<!-- Theme Style -->
	<link rel="stylesheet" href="/assets/css/style.css">

	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- FOR IE9 below -->
	<!--[if lte IE 9]>
	<script src="js/modernizr-2.6.2.min.js"></script>
	<script src="js/respond.min.js"></script>
	<![endif]-->
</head>


  <body>
    <!-- Header -->
	<header id="fh5co-header" role="banner">
		<div class="container">
			<!-- Logo -->
			<div id="fh5co-logo">
				<a href="/">
					<img src="/assets/images/logo.png" alt="Work Logo">
				</a>
			</div>
			<!-- Logo -->

			<!-- Mobile Toggle Menu Button -->
			<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>

			<!-- Main Nav -->
			<div id="fh5co-main-nav">
				<nav id="fh5co-nav" role="navigation">
					<ul>
						<li class="">
							<a href="/">Blog</a>
						</li>
						<li class="">
							<a href="/archive/">Archives</a>
						</li>
            <li class="">
							<a href="/category/">Categories</a>
						</li>
            <!-- <li class="">
							<a href="/community/">Community</a>
						</li> -->
            <li class="">
							<a href="/about/"> About me </a>
						</li>
					</ul>
					<!-- <a href="http://www.vitormeriat.com.br/" target="_blank" class="fh5co-nav-call-to-action js-fh5co-nav-call-to-action">Blog</a> -->
          <!-- <a href="/about/" class="">About me</a> -->
				</nav>
			</div>
			<!-- Main Nav -->
		</div>
	</header>
	<!-- Header -->

    <main role="main">
      <div class="container">

<article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="section-padding--lg mast">
    <a class="nav nav--white" href="/blog/">
      <i class="fa fa-lg fa-arrow-left"></i>
      <span>Back to Posts</span>
    </a>
    <figure class="absolute-bg mast__img" style="background-image: url('');"></figure>
    <div class="mast__container">
      <span><time datetime="2011-06-29T17:20:59-03:00" itemprop="datePublished">Jun 29, 2011</time></span>
      <h1 itemprop="name headline">Como retornar um tipo anônimo por método</h1>
      
        <span>
          Posted in C#
        </span>
      
      <span></span>
    </div>
  </header>

  <section class="section-padding post" itemprop="articleBody">
    <p align="justify">Os tipos anônimos são muito uteis principalmente quando estamos trabalhando com LINQ. Podemos filtrar uma lista de campos para um resultado projetando um tipo personalizado. Usar um tipo anônimo pode ser muito mais rápido que criar um novo tipo.</p>
<p align="justify">No post <a href="http://vitormeriat.wordpress.com/2011/06/09/tipos-annimos-so-realmente-teis/" target="_blank">Tipos anônimos são realmente úteis?</a>, falei sobre os tipos anônimos, suas limitações e como este recurso é útil. Um dos pontos abordados foi sobre as limitações dos tipos anônimos. Vou reproduzir o texto em questão:</p>
<blockquote><p align="justify">Os tipos anônimos apresentam limitações que devem ser conhecidas para que seu uso possa ser mais consciente. Quando se opta por usar tipos anônimos é necessário saber que eles não são símbolos C# válidos, sua validade fica a nível de CLR. Isto implica na impossibilidade de definir métodos de extensão, de declarar métodos com tipos anônimos como parâmetros e retornar tipos anônimos a partir de métodos.</p>
</blockquote>
<p align="justify">Vamos analisar o código abaixo:</p>
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/tiposanonimos01.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="tiposAnonimos01" border="0" alt="tiposAnonimos01" src="/assets/tiposanonimos01_thumb.png" width="660" height="354" /></a></p>
<p><!--more-->
<p align="justify">Este código cria uma nova instância de um tipo anônimo. É possível notar que que o compilador C# é capaz de inferir os tipos como visto no <strong>Intellisense</strong>. Depois de ter declarado o tipo você pode usá-lo como se houvesse feito uma declaração de tipo normal. O compilador C# atribui o tipo adequado para cada propriedade. Esta atribuição não se limita a valores literais, pode ser uma expressão de valor ou tipos aninhados como no exemplo a seguir: </p>
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/tiposanonimos02.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="tiposAnonimos02" border="0" alt="tiposAnonimos02" src="/assets/tiposanonimos02_thumb.png" width="342" height="234" /></a></p>
<p align="justify">Dentro do escopo do método local, o compilador entende toda a semântica do tipo. Isto tudo é muito legal mas como já foi dito o tipo anônimo é desconhecido fora do método que o criou. Não há nada de tão especial sobre este tipo - é simplesmente uma instância de um tipo de referência. A única coisa diferente sobre esse tipo é que ele tem um nome que você não pode ver.</p>
<p align="justify">Esta é uma situação em que é necessário usar a palavra-chave var. Como não sabemos qual o nome do tipo, usamos a palavra-chave var, e deixamos com o compilador a missão de inferir o tipo.</p>
<p align="justify">Então se um tipo é anônimo, como podemos fazer para que um método possa retorná-lo?</p>
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/tiposanonimos03.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="tiposAnonimos03" border="0" alt="tiposAnonimos03" src="/assets/tiposanonimos03_thumb.png" width="548" height="159" /></a></p>
<p align="justify">Se você quiser retornar um objeto a partir de um método, você deve declarar o método para retornar um objeto deste tipo. Isto está bem claro na semântica do C#, para chegarmos ao fim desejado devemos tornar nosso tipo anônimo em um tipo nominal.
<p align="justify">Não podemos retornar um <strong><font size="2">var</font></strong>, então para ser mais genérico o mais recomendado é utilizar um <strong><font size="2">object</font></strong> para o retorno. Se um um tipo anônimo é um tipo do .NET, então esse herda de <strong>System.Object</strong>, logo podemos retornar um object. Isto pode funcionar em alguns casos mais certamente você será surpreendido com impossibilidades nesta abordagem.
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/tiposanonimos04.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="tiposAnonimos04" border="0" alt="tiposAnonimos04" src="/assets/tiposanonimos04_thumb.png" width="546" height="154" /></a></p>
<p align="justify">O raciocínio está correto, porém quando o tipo é transformado para object, perdemos a possibilidade de utilização das propriedades do tipo anônimo (<strong>strong typing</strong>). </p>
<blockquote><p align="justify">Strong Typing: É uma caracteristica das linguagens de programação, onde não é permitida a modificação do tipo de dados de uma variável durante a execução dos programas.</p>
</blockquote>
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/tiposanonimos05.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="tiposAnonimos05" border="0" alt="tiposAnonimos05" src="/assets/tiposanonimos05_thumb.png" width="660" height="281" /></a></p>
<p align="justify">Este erro ocorre porque quando criamos um tipo anônimo, suas propriedades são <strong>READ ONLY</strong>. Isto significa que você pode criar o tipo anônimo, mas você não pode atribuir valores a ele após sua criação.</p>
<p align="justify">Para resolver esse problema temos 3 estratégias possíveis:</p>
<ol>
<ol>
<li>
<div align="justify">Reflection; </div>
</li>
<li>
<div align="justify">Dynamic Programming; </div>
</li>
<li>
<div align="justify">Realizar um cast do object com o tipo anônimo.</div>
</li>
</ol>
</ol>
<p align="justify">Trabalhar com <strong>reflection</strong> é bastante pesaroso sem falar nas questões de desempenho, trabalhar com programação dinâmica é bem legal mais como ainda não postei sobre este tema vamos nos ater a terceira estratégia.</p>
<p align="justify">Vejamos o código abaixo:</p>
<p><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/tiposanonimos06.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="tiposAnonimos06" border="0" alt="tiposAnonimos06" src="/assets/tiposanonimos06_thumb.png" width="537" height="536" /></a></p>
<p align="justify">Utilizando todo o poder dos <strong>Generics</strong>, conseguimos montar um método <strong>ConverteTiposPara</strong> que realiza o cas de um object para um tipo anônimo. Graças a “inferência de tipo” é possível fazer um cast sem conhecer o nome do tipo.</p>
<p align="justify">Baixar o Código Fonte do Artigo <a href="https://skydrive.live.com/?wa=wsignin1.0&amp;cid=bd055aa47a388023&amp;sc=documents#cid=BD055AA47A388023&amp;id=BD055AA47A388023%21125" target="_blank">aqui!</a></p>
<h3>Links de ajuda:</h3>
<p>Anonymous Types (C# Programming Guide)<strong>&nbsp;&nbsp; </strong><a href="http://bit.ly/69HYJd">http://bit.ly/69HYJd</a></p>
<p>&nbsp;</p>
<h3>Um grande abraço e ótimo estudo!</h3>
<p><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/03/logo.jpg"><img style="display:inline;float:left;" title="logo" border="0" alt="logo" align="left" src="/assets/logo_thumb.jpg?w=50&amp;h=98&amp;h=98" width="50" height="98" /></a>
<p><strong>&nbsp;&nbsp;&nbsp;&nbsp; Twitter: <a href="http://twitter.com/vitormeriat">@vitormeriat</a></strong><br />&nbsp;&nbsp;&nbsp;&nbsp; <a href="mailto:vitormeriat@gmail.com">vitormeriat@gmail.com</a><br />&nbsp;&nbsp;&nbsp;&nbsp; <a href="mailto:vitor.pereira@studentpartners.com.br">vitor.pereira@studentpartners.com.br</a></p></p></p>

  </section>

  <section class="profile">
    <div class="profile__card">
      <div class="profile__img">
        <figure class="absolute-bg" style="background-image: url('');"></figure>
      </div>
      <!-- <div class="profile__container">
        <p></p>
        
          <ul class="profile__social">
            
            
              <li><a class="fa fa-lg fa-github" href="" target="_blank"></a></li>
            
          </ul>
        
      </div> -->
    </div>
  </section>

</article>


  <section class="next">
    <a class="next__link" href="/2011/06/24/charge-da-semana-a-histria-da-nuvem-parte-1/" style="background-image: url('');">
      <div class="next__container">
        <span>Read Next</span>
        <h2>Charge da Semana: A história da Nuvem - Parte 1</h2>
      </div>
    </a>
  </section>

</div>

    </main>

    <!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
<script type="text/javascript" src="/assets/js/app.js"></script>-->

<footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row">
				<div class="col-md-push-6 col-md-9">
					<ul class="fh5co-footer-social">
						<li><a href="https://twitter.com/vitormeriat" target="_blank"><i class="fa fa-twitter fa-1x"></i> Twitter</a></li>
						<li><a href="https://github.com/vitormeriat" target="_blank"><i class="fa fa-github fa-1x"></i> Github</a></li>
						<li><a href="https://www.linkedin.com/in/vitormeriat" target="_blank"><i class="fa fa-linkedin fa-1x"></i> LinkedIn</a></li>
						<li><a href="https://www.instagram.com/vitormeriat/" target="_blank"><i class="fa fa-instagram fa-1x"></i> Instagram</a></li>
						<li><a href="https://www.facebook.com/vitormeriat/" target="_blank"><i class="fa fa-facebook fa-1x"></i> Facebook</a></li>
					</ul>
					<p class="fh5co-copyright">
						<small>(c) 2017 <a href="/">Meriat's</a>. All Rights Reserved. <br>
							Designed by: <a href="http://freehtml5.co/">freehtml5.co</a>  </small>
					</p>
				</div>
			</div>
		</div>
	</footer>

	<!-- Go To Top -->
	<a href="#" class="fh5co-gotop"><i class="ti-shift-left"></i></a>


	<!-- jQuery -->
	<script src="/assets/js/jquery-1.10.2.min.js"></script>
	<!-- jQuery Easing -->
	<script src="/assets/js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="/assets/js/bootstrap.js"></script>
	<!-- Owl carousel -->
	<script src="/assets/js/owl.carousel.min.js"></script>
	<!-- Magnific Popup -->
 <script src="/assets/js/jquery.magnific-popup.min.js"></script>
	<!-- Easy Responsive Tabs -->
	<script src="/assets/js/easyResponsiveTabs.js"></script>
	<!-- FastClick for Mobile/Tablets -->
	<script src="/assets/js/fastclick.js"></script>
	<!-- Velocity -->
	<script src="/assets/js/velocity.min.js"></script>
	<!-- Google Map -->
	<!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCefOgb1ZWqYtj7raVSmN4PL2WkTrc-KyA&sensor=false"></script> -->
	<!-- <script src="/assets/js/google_map.js"></script> -->
	<!-- Main JS -->
	<script src="/assets/js/main.js"></script>


  </body>
</html>
