<!DOCTYPE html>
<html>

  <head>
  <!--<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SetConfigurationSettingPublisher: Estratégias para múltiplas conexões no Azure. | Vitor Meriat</title>
  <meta name="author" content="">
  <meta name="description" content="">
  <meta property="og:title" content="SetConfigurationSettingPublisher: Estratégias para múltiplas conexões no Azure. | Vitor Meriat">
  <meta property="og:url" content="http://localhost:4000/2011/06/21/setconfigurationsettingpublisher-estratgias-para-mltiplas-conexes-no-azure/">
  <meta property="og:site_name" content="Vitor Meriat">
  <meta property="og:description" content="">
  <meta property="og:image" content="">
  <meta property="og:type" content="blog">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:description" content="">
  <meta name="twitter:title" content="SetConfigurationSettingPublisher: Estratégias para múltiplas conexões no Azure. | Vitor Meriat">
  <meta name="twitter:url" content="http://localhost:4000/2011/06/21/setconfigurationsettingpublisher-estratgias-para-mltiplas-conexes-no-azure/">
  <meta name="twitter:site" content="Vitor Meriat">
  <meta name="twitter:creator" content="@">
  <meta name="twitter:domain" content="http://localhost:4000">
  <meta property="twitter:image" content="">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata|Lora|Space+Mono:700">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">

  <link rel="alternate" type="application/rss+xml" title="Vitor Meriat" href="http://localhost:4000/feed.xml">
  <link rel="canonical" href="http://localhost:4000/2011/06/21/setconfigurationsettingpublisher-estratgias-para-mltiplas-conexes-no-azure/">

  -->



  <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Vitor Meriat</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Vitor Meriat" />
	<meta name="keywords" content="cloud computing, machine learning, big data, iot, developer, data scientist" />
	<meta name="author" content="Vitor Meriat" />

	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content="" />
	<meta property="og:image" content="" />
	<meta property="og:url" content="" />
	<meta property="og:site_name" content="" />
	<meta property="og:description" content="" />
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="/assets/favicon.ico">

	<!-- Google Webfont -->
	<link href='https://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
	<!-- Themify Icons -->
	<link rel="stylesheet" href="/assets/css/themify-icons.css">
	<!-- Icomoon Icons -->
	<link rel="stylesheet" href="/assets/css/icomoon-icons.css">
	<!-- Bootstrap -->
	<link rel="stylesheet" href="/assets/css/bootstrap.css">
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
	<link rel="stylesheet" href="/assets/css/owl.theme.default.min.css">
	<!-- Magnific Popup -->
	<link rel="stylesheet" href="/assets/css/magnific-popup.css">
	<!-- Easy Responsive Tabs -->
	<link rel="stylesheet" href="/assets/css/easy-responsive-tabs.css">
	<!-- Theme Style -->
	<link rel="stylesheet" href="/assets/css/style.css">

	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- FOR IE9 below -->
	<!--[if lte IE 9]>
	<script src="js/modernizr-2.6.2.min.js"></script>
	<script src="js/respond.min.js"></script>
	<![endif]-->
</head>


  <body>
    <!-- Header -->
	<header id="fh5co-header" role="banner">
		<div class="container">
			<!-- Logo -->
			<div id="fh5co-logo">
				<a href="/">
					<img src="/assets/images/logo.png" alt="Work Logo">
				</a>
			</div>
			<!-- Logo -->

			<!-- Mobile Toggle Menu Button -->
			<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>

			<!-- Main Nav -->
			<div id="fh5co-main-nav">
				<nav id="fh5co-nav" role="navigation">
					<ul>
						<li class="">
							<a href="/">Blog</a>
						</li>
						<li class="">
							<a href="/archive/">Archives</a>
						</li>
            <li class="">
							<a href="/category/">Categories</a>
						</li>
            <!-- <li class="">
							<a href="/community/">Community</a>
						</li> -->
            <li class="">
							<a href="/about/"> About me </a>
						</li>
					</ul>
					<!-- <a href="http://www.vitormeriat.com.br/" target="_blank" class="fh5co-nav-call-to-action js-fh5co-nav-call-to-action">Blog</a> -->
          <!-- <a href="/about/" class="">About me</a> -->
				</nav>
			</div>
			<!-- Main Nav -->
		</div>
	</header>
	<!-- Header -->

    <main role="main">
      <div class="container">

<article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="section-padding--lg mast">
    <!-- <a class="nav nav-white" href="/blog/">
      <i class="fa fa-lg fa-arrow-left"></i>
      <span>Back to Posts</span>
    </a> -->
    <figure class="absolute-bg mast__img" style="background-image: url('');"></figure>
    <div class="mast-container">
      <!-- <span><time datetime="2011-06-21T20:07:12-03:00" itemprop="datePublished">Jun 21, 2011</time></span> -->
      <h1 itemprop="name headline">SetConfigurationSettingPublisher: Estratégias para múltiplas conexões no Azure.</h1>
      <span><time datetime="2011-06-21T20:07:12-03:00" itemprop="datePublished">Jun 21, 2011</time></span>
      
        <span>
          Posted in Cloud Computing, Microsoft Azure, Microsoft Azure Storage
        </span>
      
      <span></span>
    </div>
  </header>

  <section class="section-padding post" itemprop="articleBody">
    <p><span style="font-size:x-small;"><span style="font-size:x-small;">Duas das minhas últimas postagens sobre Azure se dedicaram a explorar um dos mais comuns problemas que ocorrem no início da utilização do mesmo:</span></span></p>
<ol>
<ol>
<li><span style="color:#555555;"><a href="http://vitormeriat.wordpress.com/2011/05/25/cloudstorageaccount-e-o-mtodo-setconfigurationsettingpublisher/" target="_blank">CloudStorageAccount e o método SetConfigurationSettingPublisher</a></span>  </li>
<li><span style="color:#555555;"><a href="http://vitormeriat.wordpress.com/2011/06/07/porque-setconfigurationsettingpublisher-precisa-ser-chamado-antes-de-fromconfigurationsetting/" target="_blank">Porque SetConfigurationSettingPublisher precisa ser chamado antes de FromConfigurationSetting?</a></span> </li>
</ol>
</ol>
<p align="justify">Estes erros são muito comuns pois na maioria dos casos não é realizado um planejamento eficaz pensando nos ambientes para teste e desenvolvimento.</p>
<p align="justify">Imagine que você está desenvolvendo uma aplicação e naturalmente resolve armazenar a configuração da conta em um arquivo <strong>.config</strong> para recuperar esta informação em tempo de execução. Utilizando a solução conforme já estudamos anteriormente, conseguimos isto sem problemas após iniciar o delegate chamado por <strong>SetConfigurationSettingPublisher</strong> como na imagem abaixo:</p>
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/012.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="01" border="0" alt="01" src="/assets/01_thumb2.png" width="660" height="321" /></a></p>
<p align="justify"><em>Estou utilizando o exemplo do artigo 1 citado anterior (baixe o <a href="http://cid-bd055aa47a388023.office.live.com/self.aspx/.Public/CredenciaisAzure.rar">Código fonte do Artigo</a>).</em></p>
<p><!--more-->
<p align="justify"><em></em></p>
<p align="justify">Tudo corre perfeitamente pois você está rodando sua aplicação dentro do ambiente de desenvolvimento do Azure. Agora vamos levar em conta que durante os testes ou desenvolvimento da aplicação você executou seu projeto e por ventura ele está sendo executado como um projeto Web local e fora do ambiente Azure. O que vai acontecer???</p>
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/02.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="02" border="0" alt="02" src="/assets/02_thumb.png" width="656" height="500" /></a></p>
<p align="justify">O erro aconteceu quando a aplicação estava tentando ler a "configuração" da conta (que utiliza bibliotecas da classe 'RoleEnvironment') com o método RoleEnvironment.GetConfigurationSettingValue. Nosso código já está estruturado e conforme vimos nos artigos anteriores e na figura 1, ele está funcionando perfeitamente, entretanto quando executamos a busca de nossas credenciais temos um <strong>SEHException</strong>de presente.</p>
<p align="justify">Quando estamos executando nossa aplicação dentro do ambiente de desenvolvimento do Azure, ela irá executar utilizando a porta 81 como padrão, exatamente como na imagem abaixo. Caso a aplicação esteja fora do ambiente, teríamos um número aleatório como é comum as execuções ASP.NET.</p>
<p align="justify">&nbsp;<a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/03.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="03" border="0" alt="03" src="/assets/03_thumb.png" width="498" height="348" /></a></p>
<p align="justify">Um primeiro conceito que podemos abstrair aqui é verificar se estamos no ambiente de desenvolvimento do Azure. Isto pode ser feito utilizando o método IsAvailable da classe&nbsp; RoleEnvironment. Quando utilizamos <code><span style="color:#333333;"><strong>RoleEnvironment.IsAvailable(), </strong></span></code>recebemos um <strong>true or false</strong> indicando se o mesmo encontra-se no ambiente Azure. Quando executamos nossa aplicação fora do contexto, recebemos um <strong>false</strong> indicando isto.</p>
<p><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/04.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="04" border="0" alt="04" src="/assets/04_thumb.png" width="710" height="191" /></a></p>
<p>Agora que já sabemos como identificar em qual ambiente estamos executando e de acordo com o que já estudamos anteriormente, podemos definir uma estratégia para garantir que nossa aplicação possa executar em ambientes distintos.</p>
<p>Vamos alterar o método “<em>MeuEditorDeConfiguracao</em>” conforme o código abaixo:</p>
<p><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/05.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="05" border="0" alt="05" src="/assets/05_thumb.png" width="710" height="132" /></a></p>
<p align="justify">Notem que se o ambiente estiver disponível nós utilizamos o método <strong>GetConfigurationSettingValue</strong> para obter o valor da configuração no arquivo <strong>.cscfg</strong>, caso contrário, utilizamos o famoso <strong>WebConfigurationManager</strong> para obter a configuração que neste caso está no arquivo <strong>Web.config</strong>.</p>
<p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/06/06.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="06" border="0" alt="06" src="/assets/06_thumb.png" width="660" height="63" /></a></p>
<p align="justify">Este é um exemplo básico mas abre caminho para inúmeras possibilidades. Como desenvolvedores nos deparamos com incontáveis situações e cenários que vão exigir adaptação e flexibilidade em nossas soluções.</p>
<p align="justify">Código fonte do artigo <a href="https://skydrive.live.com/?cid=bd055aa47a388023&amp;id=BD055AA47A388023%21216#">aqui.</a></p>
<p align="justify">
<h3>&nbsp;</h3>
<h3>&nbsp;</h3>
<h3>Um grande abraço e ótimo estudo!</h3>
<p><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2011/03/logo.jpg"><img style="display:inline;float:left;" title="logo" border="0" alt="logo" align="left" src="/assets/logo_thumb.jpg?w=50&amp;h=98&amp;h=98" width="50" height="98" /></a></p>
<p><strong>&nbsp;&nbsp;&nbsp;&nbsp; Twitter: <a href="http://twitter.com/vitormeriat">@vitormeriat</a></strong><br />&nbsp;&nbsp;&nbsp;&nbsp; <a href="mailto:vitormeriat@gmail.com">vitormeriat@gmail.com</a><br />&nbsp;&nbsp;&nbsp;&nbsp; <a href="mailto:vitor.pereira@studentpartners.com.br">vitor.pereira@studentpartners.com.br</a></p></p>

  </section>

  <section class="profile">
    <div class="profile__card">
      <div class="profile__img">
        <figure class="absolute-bg" style="background-image: url('');"></figure>
      </div>
      <!-- <div class="profile__container">
        <p></p>
        
          <ul class="profile__social">
            
            
              <li><a class="fa fa-lg fa-github" href="" target="_blank"></a></li>
            
          </ul>
        
      </div> -->
    </div>
  </section>

</article>


  <section class="next">
    <a class="next__link" href="/2011/06/20/uma-viso-sobre-o-winc/" style="background-image: url('');">

      <div class="next-container" style="margin: 60px 0 60px 0;">
        <hr>
        <h4>Read Next <i class="fa fa-lg fa-arrow-right"></i></h4>
        <span style="font-size: 1.6em;">Uma visão sobre o WinC++</span>
        <hr>
      </div>

    </a>
  </section>

</div>

    </main>

    <!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
<script type="text/javascript" src="/assets/js/app.js"></script>-->

<footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row">
				<div class="col-md-push-6 col-md-9">
					<ul class="fh5co-footer-social">
						<li><a href="https://twitter.com/vitormeriat" target="_blank"><i class="fa fa-twitter fa-1x"></i> Twitter</a></li>
						<li><a href="https://github.com/vitormeriat" target="_blank"><i class="fa fa-github fa-1x"></i> Github</a></li>
						<li><a href="https://www.linkedin.com/in/vitormeriat" target="_blank"><i class="fa fa-linkedin fa-1x"></i> LinkedIn</a></li>
						<li><a href="https://www.instagram.com/vitormeriat/" target="_blank"><i class="fa fa-instagram fa-1x"></i> Instagram</a></li>
						<li><a href="https://www.facebook.com/vitormeriat/" target="_blank"><i class="fa fa-facebook fa-1x"></i> Facebook</a></li>
					</ul>
					<p class="fh5co-copyright">
						<small>(c) 2017 <a href="/">Meriat's</a>. All Rights Reserved.
							<!-- <br>Designed by: <a href="http://freehtml5.co/">freehtml5.co</a>   -->
						</small>
					</p>
				</div>
			</div>
		</div>
	</footer>

	<!-- Go To Top -->
	<a href="#" class="fh5co-gotop"><i class="ti-shift-left"></i></a>


	<!-- jQuery -->
	<script src="/assets/js/jquery-1.10.2.min.js"></script>
	<!-- jQuery Easing -->
	<script src="/assets/js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="/assets/js/bootstrap.js"></script>
	<!-- Owl carousel -->
	<script src="/assets/js/owl.carousel.min.js"></script>
	<!-- Magnific Popup -->
 <script src="/assets/js/jquery.magnific-popup.min.js"></script>
	<!-- Easy Responsive Tabs -->
	<script src="/assets/js/easyResponsiveTabs.js"></script>
	<!-- FastClick for Mobile/Tablets -->
	<script src="/assets/js/fastclick.js"></script>
	<!-- Velocity -->
	<script src="/assets/js/velocity.min.js"></script>
	<!-- Google Map -->
	<!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCefOgb1ZWqYtj7raVSmN4PL2WkTrc-KyA&sensor=false"></script> -->
	<!-- <script src="/assets/js/google_map.js"></script> -->
	<!-- Main JS -->
	<script src="/assets/js/main.js"></script>


  </body>
</html>
