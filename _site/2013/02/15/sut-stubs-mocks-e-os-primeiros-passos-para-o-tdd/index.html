<!DOCTYPE html>
<html>

  <head>

  <!-- -->



  <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Vitor Meriat</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Vitor Meriat" />
	<meta name="keywords" content="cloud computing, machine learning, big data, iot, developer, data scientist" />
	<meta name="author" content="Vitor Meriat" />

	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content="" />
	<meta property="og:image" content="" />
	<meta property="og:url" content="" />
	<meta property="og:site_name" content="" />
	<meta property="og:description" content="" />
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="/assets/favicon.ico">

	<!-- Google Webfont -->
	<link href='https://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
	<!-- Themify Icons -->
	<link rel="stylesheet" href="/assets/css/themify-icons.css">
	<!-- Icomoon Icons -->
	<link rel="stylesheet" href="/assets/css/icomoon-icons.css">
	<!-- Bootstrap -->
	<link rel="stylesheet" href="/assets/css/bootstrap.css">
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
	<link rel="stylesheet" href="/assets/css/owl.theme.default.min.css">
	<!-- Magnific Popup -->
	<link rel="stylesheet" href="/assets/css/magnific-popup.css">
	<!-- Easy Responsive Tabs -->
	<link rel="stylesheet" href="/assets/css/easy-responsive-tabs.css">
	<!-- Theme Style -->
	<link rel="stylesheet" href="/assets/css/style.css">

	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

	<!-- FOR IE9 below -->
	<!--[if lte IE 9]>
	<script src="js/modernizr-2.6.2.min.js"></script>
	<script src="js/respond.min.js"></script>
	<![endif]-->
</head>


  <body>
    <!-- Header -->
	<header id="fh5co-header" role="banner">
		<div class="container">
      <h2 class="text-center">Vitor Meriat</h2>
			<!-- Logo -->
			<div id="fh5co-logo">
				<a href="/">
					<img src="/assets/images/logo.png" alt="Work Logo">
				</a>
        <!-- <h5>Vitor Meriat </h5> -->
			</div>
			<!-- Logo -->

			<!-- Mobile Toggle Menu Button -->
			<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>

			<!-- Main Nav -->
			<div id="fh5co-main-nav">
				<nav id="fh5co-nav" role="navigation">
					<ul>
						<li class="">
							<a href="/">Blog</a>
						</li>
						<li class="">
							<a href="/archive/">Archives</a>
						</li>
            <li class="">
							<a href="/category/">Categories</a>
						</li>
            <li class="">
							<a href="/about/"> About me </a>
						</li>
					</ul>
					<!-- <a href="http://www.vitormeriat.com.br/" target="_blank" class="fh5co-nav-call-to-action js-fh5co-nav-call-to-action">Blog</a> -->
          <!-- <a href="/about/" class="">About me</a> -->
				</nav>
			</div>
			<!-- Main Nav -->
		</div>
	</header>
	<!-- Header -->

    <main role="main">
      <div class="container">

<article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">

  <div class="row">
    <div class="fh5co-spacer fh5co-spacer-sm"></div>
    <div class="col-md-12 text-center">
      <h1>SUT, Stubs, Mocks e os primeiros passos para o TDD</h1>
    </div>
    
      <h2 class="fh5co-uppercase-heading-sm text-center">
        Agile &amp; Testes
      </h2>
    
    <span><time datetime="2013-02-15T17:09:51-02:00" itemprop="datePublished">Feb 15, 2013</time></span>
  </div>

  <div class="fh5co-spacer fh5co-spacer-md"></div>

  <!-- <header class="section-padding-lg mast">
    <figure class="absolute-bg mast__img" style="background-image: url('');"></figure>
    <div class="mast-container" style="margin-bottom: 60px;">
      <h1 itemprop="name headline">SUT, Stubs, Mocks e os primeiros passos para o TDD</h1>
      <span><time datetime="2013-02-15T17:09:51-02:00" itemprop="datePublished">Feb 15, 2013</time></span>
      
        <span>
          Posted in Agile, Testes
        </span>
      
      <span></span>
    </div>
  </header> -->

  <section class="section-padding post" itemprop="articleBody">
    <p align="justify"><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2013/02/tdd.png"><img title="tdd" style="border-top:0;border-right:0;background-image:none;border-bottom:0;float:left;padding-top:0;padding-left:0;margin:0 15px 0 0;border-left:0;display:inline;padding-right:0;" border="0" alt="tdd" align="left" src="/assets/tdd_thumb.png" width="240" height="228" /></a>É consenso que os testes são de extrema importância para o desenvolvimento de um produto. Com o passar dos anos os testes foram galgando diferentes posições dentro deste mundo. Mesmo que você não seja um optante ou profundo conhecedor do <strong>TDD</strong>, é provável que já tenha escrito ou testado seu código de alguma forma. Sendo assim, é importante conhecer alguns dos mecanismos, artefatos e técnicas da disciplina de testes. </p>
<p align="justify">Existem discussões intermináveis sobre o valor dos testes em detrimento do tempo que usamos para codificá-los. O que não se discute é sobre sua importância. Podemos verificar se uma funcionalidade está corretamente implementada e garantir durante o desenvolvimento que esta implementação não será quebrada.</p>
<p align="justify">O problema é que trabalhar com testes no mundo real não é tão simples. Quando estamos desenvolvendo nossas aplicações, nos deparamos com a necessidade de testes que envolvem banco de dados, web services, componentes de terceiros e por ai vai. Tudo isso pode deixar a complexidade do teste extremamente alta tanto para escrita quanto para depuração, sem falar que isso pode tornar o seu teste falho. Imagine que você escreve um determinado teste usando um banco de dados compartilhado e durante sua rotina de execução de teste ele falha. No primeiro momento você não sabe se ocorreu alguma alteração em nível de código ou se simplesmente alteraram os valores no banco de dados levando o teste a falha.</p>
<p align="justify">É frequente ouvir equipes dizerem que não vão escrever determinados testes devido a dificuldade de traduzir certas partes do código. Ai entra um dos grandes desafios da disciplina de testes: <u>desenvolver estratégias para isolar a complexidade do código e facilitar a escrita dos testes</u>.</p>
<p align="justify">O que se segue abaixo são alguns dos termos, e dicas que para quem pretende iniciar no mundo dos testes.</p>
<p><!--more--><br />
<h2>&#160;</h2>
<h2>Conhecendo o SUT?</h2>
<p align="justify">Quando estamos estudando sobre testes é comum encontrar na literatura a sigla <strong>SUT</strong>. Geralmente ela aparece em expressões como &quot;o teste será realizado contra o SUT&quot; ou &quot;a <strong>Assert</strong> é contra o SUT&quot;. Mas o que é o SUT?</p>
<p align="justify">SUT vem do inglês<strong> System Under Test</strong> (sistema em teste) e se refere ao que estamos testando. É possível que em alguma literatura você encontre referência a <strong>CUT</strong> como sendo classe em teste ou código em teste, mas o mais usual é SUT. Quando testamos algo, nós nos referimos à ele como sendo o SUT.</p>
<p>&#160;</p>
<h2>Prevenindo contra dependências</h2>
<p align="justify">Quando escrevemos testes de unidade temos que ter em mente que eles devem executar em de maneira independente em relação ao ambiente onde está rodando. Não podemos escrever testes que rodem apenas em nossa máquina local. Nossos testes devem rodar seja na máquina do colega como no servidor de build. Para que isso ocorra devemos escrever testes independentes de infraestrutura, banco de dados, sistema operacional e qualquer coisa que não esteja sobre o domínio do desenvolvedor. Para prevenir estas situações temos objetos que nos ajudam a suprimir esta dependência e realizar o teste de maneira correta.</p>
<p align="justify">Uma das principais estratégias para ampliar a cobertura de testes nos cantos mais densos de nosso código, bem como zerar as dependências é o uso de objetos mock e stubs.</p>
<p>&#160;</p>
<h2>Conhecendo os objetos Mock e Stub?</h2>
<p align="justify">Bom iniciando meus estudos sobre testes e pondo a mão na massa, fiquei em dúvida sobre qual a diferença entre mocks e stubs (o que posteriormente observei ser uma dúvida comum).</p>
<p align="justify">Usando como base o artigo <strong>&quot;<em>Mocks Aren't Stubs</em>&quot;</strong> de <strong>Martin Fowler</strong>, temos a seguinte descrição sobre mocks e stubs:</p>
<ul>
<ul>
<li>
<div align="justify">Mocks: objetos pré-programados com informações que formam uma especificação das chamadas que esperam receber; </div>
</li>
<li>
<div align="justify">Stubs: providenciam respostas pré-configuradas para as chamadas feitas durante os testes, normalmente não respondem a nada que não esteja programado para o teste. Stubs também podem gravar informações sobre as chamadas, como um gateway que lembra as mensagens que 'enviou', ou talvez apenas quantas mensagens 'enviou'. </div>
</li>
</ul>
</ul>
<p align="justify">Conceitualmente são diferente embora na prática sejam parecidos. Inicialmente você pode pensar que diferença seja o fato de stubs serem classes estáticas e mocks serem classes dinâmicas geradas por algum tipo de ferramenta como<strong> Rhino Mocks</strong> ou <strong>NMock</strong>. Este é o ponto...</p>
<p align="justify">Stubs se diferem dos Mocks em seu uso. Stubs são usados ​​para representar e testar o estado de um objeto, enquanto Mocks testam suas interações.</p>
<p align="justify">Utilizando ainda o artigo de Martin Fowler sobre o assunto, podemos concluir que objetos Mock esperam a execução de determinados métodos e seu resultado remete a falha do teste caso a resposta não seja a esperada. </p>
<p align="justify">Já os objetos Stubs fornecem respostas &quot;enlatadas&quot; e não levam o teste de unidade a falha. Eles são usados ​​apenas para que o objeto que você está testando obtenha os dados de que necessita para realizar sua tarefa. Um &quot;stub&quot; é uma implementação de interface que existe para fornecer dados de algum tipo.</p>
<p align="justify">Um Stub é usado para substituir a dependência externa, fornecendo estado para que nossos testes sejam executados sem exceções. O Stub é adequado apenas para testar se o resultado de alguma função está correto ou não. Mock é mais complexo sendo usado para testar comportamentos, por exemplo, verificar se uma função foi chamada ou não.</p>
<p align="justify">Resumindo tudo segundo as palavras de <strong>Roy Osherove</strong> em seu livro <strong><em>&quot;The Art of Unit Testing&quot;</em></strong>, a diferença entre mocks e stubs é que mocks levam o teste a falha e stubs não.</p>
<p align="justify">Observe a ilustração abaixo:</p>
<p><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2013/02/mock-sut-stub.png"><img title="mock sut stub" style="background-image:none;float:none;padding-top:0;padding-left:0;margin-left:auto;display:block;padding-right:0;margin-right:auto;border-width:0;" border="0" alt="mock sut stub" src="/assets/mock-sut-stub_thumb.png" width="560" height="412" /></a></p>
<p>&#160;</p>
<p align="justify">A setas vermelhas indicam que o caminho do Mock pode levar o teste ao erro, já no caso do Stub não deve haver falha.</p>
<p align="justify">Logo, usamos mocks para simular comportamentos, testar comunicação entre os objetos e caso as exigências do mesmo sejam contrariadas seu teste vai falhar. Sempre deve haver apenas um mock por teste e lembre-se: o Assert é contra o mock...</p>
<p align="justify">Os stubs fornecem dados, simulam resultados, suprimem as dependências e preparam o SUT para o teste. O stub é um auxílio, podem haver vários stubs em um teste e não causam a falha do mesmo.</p>
<p>&#160;</p>
<h2>Isolando os testes</h2>
<p align="justify">Isole os testes de unidade separando o código dos testes do SUT. O usual é ter projetos separados para o SUT e os testes. Com isso você pode manter seu projeto mais organizado e evita o trabalho e a preocupação sobre o que fazer com o código de teste na hora de colocar seu sistema em produção. </p>
<p align="justify">&#160;</p>
<h2>Testando unidades</h2>
<p align="justify">Testes unitários ou de unidade se referem a pequenos pedaços de código, comumente métodos ou partes ainda menores, como escopos dentro dos métodos. Escrever testes grandes demais ou que verifiquem muitos itens do código, geralmente, indica falha no design da aplicação. Lembre-se que quanto menor for seu teste, mais fácil será a manutenção no futuro e mais rápido será o entendimento do erro causado quando um teste falhar.</p>
<p>&#160;</p>
<h2>Quanto a dificuldade</h2>
<p align="justify">Levando em consideração as boas práticas e o Princípio da Responsabilidade Única ou SRP (Single Responsibility Principle), podemos afirmar que os testes devem ser feitos sem grandes dificuldades em relação ao desing da mesma. O teste deve ter apenas um objetivo e testar apenas uma funcionalidade por vez.</p>
<p>&#160;</p>
<h3><font style="font-weight:bold;">Referências</font></h3>
<p><a href="http://martinfowler.com/articles/mocksArentStubs.html" target="_blank">Mocks Aren't Stubs</a></p>
<p>&#160;</p>
<h2>Bom estudo a todos!</h2>
<p><a href="http://meriat-blog.azurewebsites.net/wp-content/uploads/2012/06/me-azul.png"><img title="Me Azul" style="float:left;margin:0 20px 0 0;display:inline;" border="0" alt="Me Azul" align="left" src="/assets/me-azul_thumb.png?w=110&amp;h=110&amp;h=110" width="110" height="110" /></a></p>
<h3><font color="#9bbb59"><strong><font color="#4bacc6">Twitter:</font></strong> </font><a href="http://twitter.com/#!/vitormeriat"><font color="#9bbb59">@vitormeriat</font></a></h3>
<h3><a href="mailto:vitormeriat@gmail.com"><font color="#9bbb59">vitormeriat@gmail.com</font></a></h3>
<h3><a href="mailto:vitor.pereira@studentpartners.com.br"><font color="#9bbb59">vitor.pereira@studentpartner.com</font></a></h3>

  </section>

  <!-- <section class="profile">
    <div class="profile__card">
      <div class="profile__img">
        <figure class="absolute-bg" style="background-image: url('');"></figure>
      </div>
    </div>
  </section> -->

</article>


  <section class="next">
    <a class="next__link" href="/2013/01/28/testes-e-mais-testes-o-porqu-dos-testes-de-software/" style="background-image: url('');">

      <div class="next-container" style="margin: 60px 0 60px 0;">
        <hr>
        <h4>Read Next <i class="fa fa-lg fa-arrow-right"></i></h4>
        <span style="font-size: 1.6em;">Testes e mais testes... O porquê dos testes de software.</span>
        <hr>
      </div>

    </a>
  </section>

</div>

    </main>

    <!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
<script type="text/javascript" src="/assets/js/app.js"></script>-->

<footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row">
				<div class="col-md-push-6 col-md-9">
					<ul class="fh5co-footer-social">
						<li><a href="https://twitter.com/vitormeriat" target="_blank"><i class="fa fa-twitter fa-1x"></i> Twitter</a></li>
						<li><a href="https://github.com/vitormeriat" target="_blank"><i class="fa fa-github fa-1x"></i> Github</a></li>
						<li><a href="https://www.linkedin.com/in/vitormeriat" target="_blank"><i class="fa fa-linkedin fa-1x"></i> LinkedIn</a></li>
						<li><a href="https://www.instagram.com/vitormeriat/" target="_blank"><i class="fa fa-instagram fa-1x"></i> Instagram</a></li>
						<li><a href="https://www.facebook.com/vitormeriat/" target="_blank"><i class="fa fa-facebook fa-1x"></i> Facebook</a></li>
					</ul>
					<p class="fh5co-copyright">
						<small>(c) 2017 <a href="/">Meriat's</a>. All Rights Reserved.
							<!-- <br>Designed by: <a href="http://freehtml5.co/">freehtml5.co</a>   -->
						</small>
					</p>
				</div>
			</div>
		</div>
	</footer>

	<!-- Go To Top -->
	<a href="#" class="fh5co-gotop"><i class="ti-shift-left"></i></a>


	<!-- jQuery -->
	<script src="/assets/js/jquery-1.10.2.min.js"></script>
	<!-- jQuery Easing -->
	<script src="/assets/js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="/assets/js/bootstrap.js"></script>
	<!-- Owl carousel -->
	<script src="/assets/js/owl.carousel.min.js"></script>
	<!-- Magnific Popup -->
 <script src="/assets/js/jquery.magnific-popup.min.js"></script>
	<!-- Easy Responsive Tabs -->
	<script src="/assets/js/easyResponsiveTabs.js"></script>
	<!-- FastClick for Mobile/Tablets -->
	<script src="/assets/js/fastclick.js"></script>
	<!-- Velocity -->
	<script src="/assets/js/velocity.min.js"></script>
	<!-- Google Map -->
	<!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCefOgb1ZWqYtj7raVSmN4PL2WkTrc-KyA&sensor=false"></script> -->
	<!-- <script src="/assets/js/google_map.js"></script> -->
	<!-- Main JS -->
	<script src="/assets/js/main.js"></script>


  </body>
</html>
