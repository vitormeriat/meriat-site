<!DOCTYPE html>
<html>

  ﻿<head>
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-90757610-1', 'auto');
    ga('send', 'pageview');
  </script>

  <script type="text/javascript">
  var appInsights=window.appInsights||function(config){
    function i(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},u=document,e=window,o="script",s="AuthenticatedUserContext",h="start",c="stop",l="Track",a=l+"Event",v=l+"Page",y=u.createElement(o),r,f;y.src=config.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js";u.getElementsByTagName(o)[0].parentNode.appendChild(y);try{t.cookie=u.cookie}catch(p){}for(t.queue=[],t.version="1.0",r=["Event","Exception","Metric","PageView","Trace","Dependency"];r.length;)i("track"+r.pop());return i("set"+s),i("clear"+s),i(h+a),i(c+a),i(h+v),i(c+v),i("flush"),config.disableExceptionTracking||(r="onerror",i("_"+r),f=e[r],e[r]=function(config,i,u,e,o){var s=f&&f(config,i,u,e,o);return s!==!0&&t["_"+r](config,i,u,e,o),s}),t
    }({
        instrumentationKey:"d4823b90-66dc-43d1-84c6-7da8a3796ebd"
    });
    window.appInsights=appInsights;
    appInsights.trackPageView();
</script>

  <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Vitor Meriat</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Vitor Meriat" />
	<meta name="keywords" content="cloud computing, machine learning, big data, iot, developer, data scientist" />
	<meta name="author" content="Vitor Meriat" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="/assets/favicon.ico">

	<!-- Google Webfont -->
	<link href='https://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
	<!-- Themify Icons -->
	<link rel="stylesheet" href="/assets/css/themify-icons.css">
	<!-- Icomoon Icons -->
	<link rel="stylesheet" href="/assets/css/icomoon-icons.css">
	<!-- Bootstrap -->
	<link rel="stylesheet" href="/assets/css/bootstrap.css">
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="/assets/css/owl.carousel.min.css">
	<link rel="stylesheet" href="/assets/css/owl.theme.default.min.css">
	<!-- Magnific Popup -->
	<link rel="stylesheet" href="/assets/css/magnific-popup.css">
	<!-- Easy Responsive Tabs -->
	<link rel="stylesheet" href="/assets/css/easy-responsive-tabs.css">
	<!-- Theme Style -->
	<link rel="stylesheet" href="/assets/css/style.css?v1">

	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

	<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
	<link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/obsidian.css">

	<script>hljs.initHighlightingOnLoad();</script>

	<!-- FOR IE9 below -->
	<!--[if lte IE 9]>
	<script src="js/modernizr-2.6.2.min.js"></script>
	<script src="js/respond.min.js"></script>
	<![endif]-->
</head>


  <body>
    <!-- Header -->
	<header id="fh5co-header" role="banner">
		<div class="container">
      <div id="fh5co-logo">
				<a href="/">
					<img src="/assets/images/logo-d.png" alt="Work Logo">
				</a>
			</div>
      <div style="text-align: center;">
        <a href="/"><h2 style="margin-top: 0px !important;">Vitor Meriat</h2></a>
        <span style="font-size: 1em; color: black;">MVP Azure - Cloud Architect - Data science enthusiast</span>
      </div>
			<!-- Mobile Toggle Menu Button -->
			<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>

			<!-- Main Nav -->
			<div id="fh5co-main-nav">
				<nav id="fh5co-nav" role="navigation">
					<ul>
						<li class="">
							<a href="/">Blog</a>
						</li>
						<li class="">
							<a href="/archive/">Archives</a>
						</li>
            <li class="">
							<a href="/category/">Categories</a>
						</li>
            <li class="">
							<a href="/about/"> About me </a>
						</li>
					</ul>
					<!-- <a href="http://www.vitormeriat.com.br/" target="_blank" class="fh5co-nav-call-to-action js-fh5co-nav-call-to-action">Blog</a> -->
          <!-- <a href="/about/" class="">About me</a> -->
				</nav>
			</div>
			<!-- Main Nav -->
		</div>
	</header>
	<!-- Header -->
    <main role="main">
      <div class="container">
  <article itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="row">
      <div class="fh5co-spacer fh5co-spacer-sm"></div>
      <div class="col-md-12 text-center">
        <h1>Services now–Criando e testando um WCF Service Web Role On-Premise</h1>
        
      </div>
      
        <h2 class="fh5co-uppercase-heading-sm text-center">
          Microsoft Azure &amp; Services &amp; WCF
        </h2>
      
      <span><time datetime="2014-11-23T00:00:00-02:00" itemprop="datePublished">Nov 23, 2014</time></span>
    </div>
    <div class="fh5co-spacer fh5co-spacer-md"></div>
    <section class="section-padding post" itemprop="articleBody">
      <p align="justify"><a href="http://blob.vitormeriat.com.br/images/2014/11/capawcf.png"><img alt="capaWCF" src="http://blob.vitormeriat.com.br/images/2014/11/capawcf.png" /></a></p>
<p align="justify">O <strong>WCF Service Role</strong> nos permite criar um serviço <strong>WFC </strong>hospedado em um <strong>Cloud Service</strong> no <strong>Microsoft Azure</strong>. Neste post vamos criar e testar um WCF Service Web Role local e na nuvem.</p>
<p><!--more-->
<p align="justify">Com o WCF (<em><strong>Windows Communication Foundation</strong></em>), a Microsoft unificou as várias tecnologias de programação distribuídas em um único modelo baseado na arquitetura orientada à serviços (SOA). Não vou falar especificamente sobre o WCF neste post, porém vou abordar especificamente sobre isso em breve.</p>
<p align="justify">Agora vamos criar o nosso projeto: Inicie o <strong>Visual Studio</strong> e selecione a opção <strong>New Project</strong>. Em <strong>Templates</strong> selecione <strong>Cloud</strong> e crie um <strong>Windows Azure Cloud Service</strong>. No meu exemplo estou chamando de <strong>WindowsAzureWCF</strong>. Vale notar que o ambiente utilizado neste post foi o <strong>Visual Studio 2013</strong> e o<strong> Windows Azure SDK 2.5</strong>.</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg01.png"><img alt="ATG01" src="http://blob.vitormeriat.com.br/images/2014/11/atg01.png" /></a></p>
<p>&nbsp;</p>
<p align="justify">Na próxima tela selecionamos a <strong>WCF Service Web Role</strong>. Neste exemplo estou alterando o nome para <strong>WCFService.Bissexto</strong>.</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg02.png"><img alt="ATG02" src="http://blob.vitormeriat.com.br/images/2014/11/atg02.png" /></a></p>
<p>&nbsp;</p>
<p>Você vai perceber que ele cria uma estrutura idêntica a um serviço WCF padrão:</p>
<ol>
<ol>
<li><strong>IService1.cs </strong>(Contrato do Serviço)  </li>
<li><strong>Service1.svc.cs</strong> (Definição do Serviço)  </li>
<li><strong>Web.config </strong>(Configuração dos EndPoints) </li>
</ol>
</ol>
<p align="justify">Agora vamos alterar nosso contrato e o nosso serviço para o retorno esperado. Só para não perder a oportunidade, vamos adicionar ao método padrão <strong>GetData</strong>, uma lógica para verificar se o ano é <strong>bissexto </strong>ou não. Para isso, devemos saber que os anos são bissextos quando forem divisíveis por 4, excluindo os que sejam divisíveis por 100, porém não os que sejam divisíveis por 400. Isso porque os anos divisíveis por 4 são bissextos, porém a cada 400 anos devemos eliminar 3 anos bissextos.</p>
<p align="justify">No arquivo de definição do serviço, <strong>Service1.svc.cs,</strong> você pode deletar o outro método padrão e incluir a lógica da verificação do ano bissexto, deixando o código como o descrito abaixo:</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg03.png"><img alt="ATG03" src="http://blob.vitormeriat.com.br/images/2014/11/atg03.png" /></a></p>
<p>&nbsp;</p>
<p>Altere também o contrato conforme o código abaixo:</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg04.png"><img title="ATG04" alt="ATG04" src="http://blob.vitormeriat.com.br/images/2014/11/atg04.png" /></a></p>
<p align="justify">Não iremos alterar o nosso <strong>Web.config </strong>. Verifique se o Visual Studio está rodando com permissão de <strong>Administrator</strong>, que o projeto <strong>WindowsAzureWCF</strong> esteja setado como <strong>StartUp Project</strong> e o <strong>Windows Azure Compute Emulator</strong> esteja rodando. Depois é só inicar a aplicação normalmente.</p>
<p align="justify">Se você observar o <strong>Computer Emulator</strong> (que emula o mesmo ambiente encontrado na nuvem), vai ver que o nosso serviço WCF está executando normalmente:</p>
<p align="justify"><a href="http://blob.vitormeriat.com.br/images/2014/11/atg06.png"><img alt="ATG06" src="http://blob.vitormeriat.com.br/images/2014/11/atg06.png" /></a></p>
<p>Note que a seguinte tela é apresentada:</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg08.png"><img alt="ATG08" src="http://blob.vitormeriat.com.br/images/2014/11/atg08.png" /></a></p>
<p align="justify">Navegue para a o serviço. Sua URL deve ficar <a href="http://127.0.0.1:4318/Service1.svc">http://127.0.0.1:4318/Service1.svc</a>. Se tudo estiver correto você vai ver esta página:</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg09.png"><img alt="ATG09" src="http://blob.vitormeriat.com.br/images/2014/11/atg09.png" /></a></p>
<p align="justify">Pronto, neste ponto você já tem o serviço funcional e rodando no ambiente local. O próximo passo será a criação do cliente para consumir nosso serviço. Sendo assim, clique com o botão direito na solução e adicione um novo projeto do tipo <strong>Console Application</strong>.</p>
<p align="justify">Neste exemplo eu criei um projeto chamado <strong>TesteWCFAzure</strong>. No projeto, clique com o botão direito sobre <strong>References</strong> e selecione a opção <strong>Add Service Reference</strong>. Neste ponto você tem duas opções, <strong>Discover</strong> para que seja buscado um serviço na solução, ou <strong>Go</strong> caso você já saiba exatamente qual o serviço a ser consumido. Neste exemplo, informe o <u>endereço do serviço rodando localmente. </u>Note que são exibidas os métodos que estão expostos no contrato, neste caso apenas o <strong>GetData</strong>. Para seguir este exemplo apenas clique na opção <strong>Go</strong>. Não é necessário alterar mais nada.</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg010.png"><img alt="ATG010" src="http://blob.vitormeriat.com.br/images/2014/11/atg010.png" /></a></p>
<p align="justify">Agora com as seguintes referências, só precisamos codificar nosso cliente criando nossa proxy de chamada ao serviço. Insira o código abaixo:</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg011.png"><img alt="ATG011" src="http://blob.vitormeriat.com.br/images/2014/11/atg011.png" /></a></p>
<p align="justify">Agora é só clicar com o botão direito no projeto, <strong>Debug</strong> e <strong>Start new instance</strong>. O resultado será a resposta das duas chamadas realizadas no código acima. A resposta será como se segue abaixo:</p>
<p><a href="http://blob.vitormeriat.com.br/images/2014/11/atg012.png"><img alt="ATG012" src="http://blob.vitormeriat.com.br/images/2014/11/atg012.png" /></a></p>
<p align="justify">Pronto, já temos o nosso serviço <strong>WCF</strong> criado e testado. No próximo post vamos publicar e consumir nosso serviço na nuvem.</p>
<p align="justify">O código fonte completo vai estar disponível no próximo post: <strong><u>Criando e testando um WCF Service Web Role em um Cloud Service</u></strong>.</p>
<p>&nbsp;</p>
<h4><font color="#9bbb59">Bons estudos e até a próxima pessoal&nbsp; ;)</font></h4>
</p>

    </section>
  </article>

  <hr/>
  <section class="author">
  	<header> <a href=""> <img class="profile" src="/assets/images/profile.jpg" alt="Author's profile picture"></a></header>
  	<article>
  		<!-- Author Name -->
      	<h4>  </h4>
      	<!-- Author Bio -->
      	<p>
      		Vitor is a computer scientist who is passionate about creating software that will positively change the world we live in.
      	</p>
        <p>Share this post: <a href="http://twitter.com/share?text=Services now–Criando e testando um WCF Service Web Role On-Premise&amp;url=http://localhost:4000/2014/11/23/criando-e-testando-um-wcf-service-web-role-on-premise/"
          target="_blank"><i class="fa fa-twitter fa-1x"></i> Twitter</a> - 
          <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/2014/11/23/criando-e-testando-um-wcf-service-web-role-on-premise/"
            target="_blank"><i class="fa fa-facebook fa-1x"></i> Facebook</a></p>
      </article>
  </section>
  <hr/>

  <div style="margin-top: 60px; margin-bottom: 60px;">
    
    
      3 minutes to read
    
  </div>

  <div class="PageNavigation">
  
    <a class="prev" href="/2014/11/21/mensageria-e-os-protocoloschoose-your-poison/"><i class="fa fa-lg fa-arrow-left"></i> Mensageria e os Protocolos–Choose your poison</a>
  
  
    <a class="next" href="/2014/11/24/criando-e-testando-um-wcf-service-web-role-em-um-cloud-service/">Services now–Criando e testando um WCF Service Web Role em um Cloud Service <i class="fa fa-lg fa-arrow-right"></i></a>
  
  </div>
</div>
<div style="height: 80px;"></div>

    </main>

    <footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row">
				<div class="col-md-push-6 col-md-9">
					<ul class="fh5co-footer-social">
						<li><a href="https://twitter.com/vitormeriat" target="_blank"><i class="fa fa-twitter fa-1x"></i> Twitter</a></li>
						<li><a href="https://github.com/vitormeriat" target="_blank"><i class="fa fa-github fa-1x"></i> Github</a></li>
						<li><a href="https://www.linkedin.com/in/vitormeriat" target="_blank"><i class="fa fa-linkedin fa-1x"></i> LinkedIn</a></li>
						<li><a href="https://www.instagram.com/vitormeriat/" target="_blank"><i class="fa fa-instagram fa-1x"></i> Instagram</a></li>
						<li><a href="https://www.facebook.com/vitormeriat/" target="_blank"><i class="fa fa-facebook fa-1x"></i> Facebook</a></li>
					</ul>
					<p class="fh5co-copyright">
						<small>(c) 2017 <a href="/">Meriat's</a>. All Rights Reserved.
						</small>
					</p>
				</div>
			</div>
		</div>
	</footer>

	<!-- Go To Top -->
	<a href="#" class="fh5co-gotop"><i class="ti-shift-left"></i></a>

	<!-- jQuery -->
	<script src="/assets/js/jquery-1.10.2.min.js"></script>
	<!-- jQuery Easing -->
	<script src="/assets/js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="/assets/js/bootstrap.js"></script>
	<!-- Owl carousel -->
	<script src="/assets/js/owl.carousel.min.js"></script>
	<!-- Magnific Popup -->
 <script src="/assets/js/jquery.magnific-popup.min.js"></script>
	<!-- Easy Responsive Tabs -->
	<script src="/assets/js/easyResponsiveTabs.js"></script>
	<!-- FastClick for Mobile/Tablets -->
	<script src="/assets/js/fastclick.js"></script>
	<!-- Velocity -->
	<script src="/assets/js/velocity.min.js"></script>
	<!-- Main JS -->
	<script src="/assets/js/main.js"></script>


  </body>
</html>
