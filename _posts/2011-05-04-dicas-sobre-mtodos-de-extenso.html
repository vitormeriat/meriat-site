---
layout: post
title: Dicas sobre Métodos de Extensão
date: 2011-05-04 13:23:12.000000000 -03:00
type: post
published: true
status: publish
categories:
- C#
tags: []
meta:
  _oembed_2c1be36769ff4c80419cb4eb199461c6: "{{unknown}}"
author:
  login: vitormeriat
  email: vitormeriat@hotmail.com
  display_name: vitormeriat
  first_name: ''
  last_name: ''
---
<p align="justify">No post anterior estive falando sobre os métodos de extensão. Como surgiram algumas dúvidas(minhas e de alguns colegas) sobre este tema, resolvi aprofundar um pouco mais e estou compartilhando agora algumas dicas do uso prático deste recurso.</p>
<h3 align="justify">Métodos de Extensão em Resumo</h3>
<p align="justify">Os Métodos de Extensão permitem que um tipo existente seja estendido com métodos novos, sem alterar a definação do tipo original. Ele é um <strong>método estático</strong> de uma classe estática, onde o modificador <strong>this</strong> é aplicado ao primeiro parâmetro. O tipo do primeiro parâmetro será o tipo estendido. <u><a href="http://vitormeriat.wordpress.com/2011/04/24/mtodos-de-extenso/" target="_blank">Leia mais sobre este assunto.</a></u></p>
<h3 align="justify">Encadeamento do Método de Extensão</h3>
<p align="justify">Os métodos de extensão, assim como os métodos de instância, oferecem uma forma ordenada de encadear funções. Observe as duas funções abaixo:</p>
<p align="justify"><a href="https://meriatsite.blob.core.windows.net/images/2011/05/001.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="001" border="0" alt="001" src="{{ site.baseurl }}/assets/001_thumb.png" width="482" height="148" /></a></p>
<p align="justify">Agora que nossos métodos de extensão estão prontos, quero em uma determinada situação, que o meu termo seja pluralizado e que tenha apenas sua primeira letra maiúscula. Em outras palavras, que utilizar meus métodos de forma encadeada. Observe a figura abaixo:</p>
<p align="justify"><a href="https://meriatsite.blob.core.windows.net/images/2011/05/02.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="02" border="0" alt="02" src="{{ site.baseurl }}/assets/02_thumb.png" width="482" height="51" /></a></p>
<p align="justify">Sabemos que os termos 1 e 2 são equivalentes porém o termo1 utiliza métodos de extensão , enquanto o termo2 utiliza métodos estáticos.</p>
<h3 align="justify">Restrição aos métodos de extensão</h3>
<p align="justify">Se você já está usando métodos de extensão, fatalmente você pode imaginar algo como manipular variáveis da classe a ser estendida. Pois é, isso não é possível.</p>
<p align="justify">O compilador do C# trata o método de extensão como se fosse um método estático da pertencente a classe, e isso nos restringe o acesso aos membros internos da classe.</p>
<h3 align="justify">Métodos de Extensão para Download</h3>
<p align="justify">Imagine um método ToInt32() disponível na classe String os invés do famoso Convert.ToInt32(“minhaString”). Isso pode ser bem útil, assim como inúmeros outros métodos.</p>
<p align="justify">Uma boa dica é o site <a href="http://www.extensionmethod.net/">http://www.extensionmethod.net/</a> onde temos inúmeros métodos de extensão comentados e disponíveis para download. Você pode criar uma classe utilitária com todos estes métodos selecionados especialmente para seu projeto.</p>
<h3 align="justify">Métodos de extensão versus Métodos de instância</h3>
<p align="justify">Durante uma implementação, percebi que tinha dois métodos com a mesma assinatura, sendo que um estava declarado na classe e o outro era meu método de extensão. Sei que isso parece sem propósito mas a dúvida ficou no ar… qual método teria prioridade? Vejamos a implementação abaixo</p>
<p><a href="https://meriatsite.blob.core.windows.net/images/2011/05/01.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="01" border="0" alt="01" src="{{ site.baseurl }}/assets/01_thumb.png" width="482" height="428" /></a></p>
<p align="justify">A saída de nosso exemplo será: <strong>Impressão do Método de Instância!</strong></p>
<p align="justify">Quando executarmos a chamada ao método da <strong>instância</strong> de nossa classe, o método de instância será executado. Você pode usar os métodos de extensão para estender uma classe ou interface, mas não para substituí-las.</p>
<p align="justify">Um método de extensão com o mesmo nome e assinatura de um método da instância nunca será chamado. No momento da <strong>Compilação</strong>, os métodos de instância sempre terão prioridade em relação aos métodos estendidos. Quando o compilador&nbsp; tem uma chamada a método, ele primeiro procura por repetições nos métodos de instância. Se não houver nenhuma ele irá pesquisar os métodos de extensão e se seus tipos são compatíveis.</p>
<h3 align="justify">Método de Extensão versus Método de Extensão</h3>
<p align="justify">O que acontece se tivermos dois métodos de extensão com a mesma assinatura? Considere o seguinte exemplo:</p>
<p align="justify"><a href="https://meriatsite.blob.core.windows.net/images/2011/05/03.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="03" border="0" alt="03" src="{{ site.baseurl }}/assets/03_thumb.png" width="406" height="208" /></a></p>
<p align="justify">Se houver dois ou mais métodos com a mesma assinatura, devemos trabalhar utilizando-os como métodos estáticos para evitar a ambiguidade. Caso contrário, o compilador irá chamar o método que possui argumentos mais <strong>específicos</strong>.</p>
<p align="justify"><a href="https://meriatsite.blob.core.windows.net/images/2011/05/04.png"><img style="background-image:none;padding-left:0;padding-right:0;display:block;float:none;margin-left:auto;margin-right:auto;padding-top:0;border-width:0;" title="04" border="0" alt="04" src="{{ site.baseurl }}/assets/04_thumb.png" width="330" height="59" /></a></p>
<p align="justify">O código acima faz uso do método de extensão e irá chamar o método EhPermitido do StringFunctions. Caso você queira chamar o método EhPermitido do ObjectFunctions, será necessário especificá-lo explicitamente: <strong><font size="2">ObjectFunctions.EhPermitido(“meriat”)</font></strong>. </p>
<p align="justify">Em nosso exemplo, o primeiro método tem como argumento um strin e o segundo um object. A classe string herda de object e portanto é mais <strong>específica </strong>em suas funções.</p>
<hr />
<p align="justify"><strong>PS:</strong> Em geral, é recomendável implementar métodos de extensão com moderação e apenas quando necessário. Bom senso é algo fundamental para ser um bom programador!</p>
<p><a href="https://meriatsite.blob.core.windows.net/images/2011/03/logo.jpg"><img title="logo" border="0" alt="logo" align="left" src="{{ site.baseurl }}/assets/logo_thumb.jpg?w=50&amp;h=98&amp;h=98" width="50" height="98" /></a><font size="3">Um grande abraço e ótimo estudo!</font>
<p><strong>&nbsp;&nbsp; Twitter: <a href="http://twitter.com/vitormeriat">@vitormeriat</a></strong><br />&nbsp;&nbsp;&nbsp; <a href="mailto:vitormeriat@gmail.com">vitormeriat@gmail.com</a><br />&nbsp;&nbsp;&nbsp; <a href="mailto:vitor.pereira@studentpartners.com.br">vitor.pereira@studentpartners.com.br</a></p></p>
