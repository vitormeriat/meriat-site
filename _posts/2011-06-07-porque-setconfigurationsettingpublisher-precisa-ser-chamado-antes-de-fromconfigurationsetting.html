---
layout: post
title: Porque SetConfigurationSettingPublisher precisa ser chamado antes de FromConfigurationSetting?
date: 2011-06-07 11:28:00.000000000 -03:00
type: post
published: true
status: publish
categories:
- Cloud Computing
- Microsoft Azure
- Microsoft Azure Storage
tags: []
meta:
  _wpas_skip_twitter: '1'
  _wpas_skip_ms: '1'
  tagazine-media: ''
  image_url: https://meriatsite.blob.core.windows.net/images/2011/06/01_thumb.png
  image_tag: <img src="https://meriatsite.blob.core.windows.net/images/2011/06/01_thumb.png"
    alt="" />
  image_colors_bg: a:11:{i:0;s:6:"668874";s:2:"+1";s:6:"7d9a89";s:2:"+2";s:6:"8da697";s:2:"+3";s:6:"b3c4ba";s:2:"+4";s:6:"d9e1dc";s:2:"+5";s:6:"f0f4f2";i:-1;s:6:"577463";i:-2;s:6:"4d6657";i:-3;s:6:"33443a";i:-4;s:6:"1a221d";i:-5;s:6:"0a0e0c";}
  image_colors_fg: a:11:{i:0;s:6:"ffffff";s:2:"+1";s:6:"000000";s:2:"+2";s:6:"000000";s:2:"+3";s:6:"1a221d";s:2:"+4";s:6:"4d6657";s:2:"+5";s:6:"4d6657";i:-1;s:6:"ffffff";i:-2;s:6:"d9e1dc";i:-3;s:6:"d9e1dc";i:-4;s:6:"b3c4ba";i:-5;s:6:"8da697";}
  image_size: a:6:{i:0;s:3:"482";i:1;s:3:"338";i:2;s:1:"3";i:3;s:24:"width="482" height="338"";s:4:"bits";s:1:"8";s:4:"mime";s:9:"image/png";}
  _wpas_done_twitter: '1'
author:
  login: vitormeriat
  email: vitormeriat@hotmail.com
  display_name: vitormeriat
  first_name: ''
  last_name: ''
---
<p align="justify">No post anterior(ver <a href="http://vitormeriat.wordpress.com/2011/05/25/cloudstorageaccount-e-o-mtodo-setconfigurationsettingpublisher/">aqui</a>) falei sobre a experiência ou aventura que é montar uma estratégia para o credenciamento da conta no Azure. Como já recebi alguns emails com perguntas e críticas, resolvi me apressar para liquidar(pelo menos em parte) com este assunto.</p>
<p align="justify">Quem durante seus estudos sobre Azure não se deparou com o famoso erro:</p>
<p align="justify"><a href="https://meriatsite.blob.core.windows.net/images/2011/06/011.png"><img style="background-image:none;padding-left:0;padding-right:0;display:inline;padding-top:0;border-width:0;" title="01" border="0" alt="01" src="{{ site.baseurl }}/assets/01_thumb1.png" width="580" height="406" /></a></p>
<p><!--more-->
<p align="justify">Quando utilizamos o método <em>FromConfigurationSetting</em>, o Azure irá procurar por um editor de configuração.</p>
<p align="justify">A descrição de <a href="http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&amp;l=EN-US&amp;k=k(MICROSOFT.WINDOWSAZURE.CLOUDSTORAGEACCOUNT.FROMCONFIGURATIONSETTING);k(TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22);k(DevLang-CSHARP)&amp;rd=true" target="_blank">CloudStorageAccount.FromConfigurationSetting</a> no próprio site da <a href="http://msdn.microsoft.com" target="_blank">MSDN</a> é a seguinte:</p>
<div align="justify">
<blockquote>
<p>Create a new instance of a CloudStorageAccount object from a specified configuration setting. This method may be called only after the SetConfigurationSettingPublisher method has been called to configure the global configuration setting publisher.</p>
</blockquote>
</div>
<p align="justify">Note que na descrição do método está um aviso em alto e bom som indicando que este método só pode ser <span style="text-decoration:underline;">chamado</span> após o método SetConfigurationSettingPublisher ser <span style="text-decoration:underline;">chamado</span> para configurar o editor global de definição de configuração. (…)</p>
<p align="justify">O método FromConfigurationSetting executa o delegate com a lógica específica para obter as credenciais da conta. Este delegate por sua vez é invocado pelos método SetConfigurationSettingPublisher e este é o motivo pelo qual a mensagem de erro diz que este método <span style="text-decoration:underline;">deve ser chamado primeiro</span>. Em resumo:</p>
<ol>
<li>
<div align="justify">Você chama SetConfigurationSettingPublisher passando a lógica para obter os dados da conta;</div>
</li>
<li>
<div align="justify">Você chama FromConfigurationSetting passando o nome da configuração que o delegate(ou outra lógica…) vai usar para selecionar o valor correto;</div>
</li>
<li>
<div align="justify">FromConfigurationSetting executa o delegate e cria o ambiente que permite a criação correta da instância de CloudStorageAccount. Nosso ponto de partida para as credenciais de conta no Azure.</div>
</li>
</ol>
<p align="justify">Até aqui é tudo muito tranquilo, o interessante aqui é que o método FromConfigurationSetting não sabe onde você armazena as informações de conexão, é com SetConfigurationSettingPublisher que conseguimos adquirir as informações da conexão, bem como sua fonte. Sendo assim podemos utilizar de outras estratégias para armazenar nossas credenciais. Mas isto fica para o próximo post!</p>
<p align="justify">&nbsp;</p>
<h2></h2>
<h3 align="justify">Um grande abraço e ótimo Estudo!</h3>
<p align="justify"><a href="https://meriatsite.blob.core.windows.net/images/2011/03/logo.jpg"><span style="font-size:small;"><img style="display:inline;float:left;margin-left:0;margin-right:0;" title="logo" border="0" alt="logo" align="left" src="{{ site.baseurl }}/assets/logo_thumb.jpg?w=50&amp;h=98&amp;h=98" width="50" height="98" /></span></a><strong>&nbsp;&nbsp;&nbsp;&nbsp; Twitter: <a href="http://twitter.com/vitormeriat">@vitormeriat</a></strong><br />&nbsp;&nbsp;&nbsp;&nbsp; <a href="mailto:vitormeriat@gmail.com">vitormeriat@gmail.com</a><br />&nbsp;&nbsp;&nbsp;&nbsp; <a href="mailto:vitor.pereira@studentpartners.com.br">vitor.pereira@studentpartners.com.br</a></p>
